\documentclass[a4paper,masters,en,listoffigures,listoftables]{NMBU}

% If you'd like to use chapters instead of sections, add 'book' to the options, as \documentclass[book,...]{NMBU}. Recall that you now have to use \chapter{} and then \section{}, \subsection{}, ... 

% \usepackage[nohyperlinks]{acronym} % If you need a List of Acronyms, consider using this package

% \usepackage[font=small]{caption} % if you prefer smaller captions
% \captionsetup{width=0.9\linewidth} 

% Word of advice: When you are done with your thesis, change the compiler in Overleaf to XeLaTeX! This will make your fonts and title page look much nicer than in pdfLaTeX. Just go to "Menu", in the "Settings", find "Compiler" and change to XeLaTeX.

% The NMBU style package is designed to help you write the cover and back page automatically. Make sure to include the information below to generate your title. You can set the language you are writing in with "en" for english, "bm" for bokmål, or "nn" for nynorsk.

% A table of contents is automatically included. If you have more than one figure, you need a list of figures by adding "listoffigures" to the documentclass parameters. If you have more than one table, you need a list of tables by adding "listoftables" to the documentclass parameters.

% Additional packages
\usepackage{algorithm}
\usepackage{algpseudocode}  % modern and recommended

\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}
\renewcommand{\v}[1]{\boldsymbol{#1}}

% If you would like to have a bibliography with named authors, organised alphabetically, add "namedauthors" to the parameters of the document class.
\addbibresource{bib.bib} % here you include the bibliography file. 
\graphicspath{{../figures/}}

% If you are using Norwegian dates in your bibliography, add "norwegiandates" to the document class.

% When you finish your thesis, switch the LaTeX compiler from pdfLaTeX to XelaTeX (on Overleaf, "Menu"->"Compiler"). This is for 2 reasons: 1) to produce your front page with the Arial font; 2) XeLaTeX produces better fonts and (usually) smaller PDFs. Every kilobyte of space we save helps reduce CO2 emissions :)

% Good luck with your thesis! If you get in trouble with LaTeX stuff, write to me: leonardo.rydin@gmail.com

% In your .tex file, you need to include the following information to produce the first page of your thesis

\title{Matrix-Free Randomized Sketching for Column-Norm Estimation of Discretized PDE Operator}
\author{Elias Jegervatn Severinsen}
\thesisyear{2026}
\credits{30}
\faculty{Faculty of Science and Technology}
\supervisor{Ole Løseth Elvetun, Jonas Kusch} % Include the name of the supervisor or supervisors (this is added to the metadata of the PDF)
%\engtitle{} % Only if you write a thesis in a Scandinavian language

% You should also use the "\abstract" and "\sammendrag" to produce those. If you are writing in a Scandinavian language, the sammendrag will appear first.
\abstract{This thesis uses randomized linear algebra for estimation of a discrete PDE operator.}
%\sammendrag{Write your sammendrag here}
%\acknowledgements{} You can add acknowledgements here. In Scandinavian languages, use "\foreword{}" (or if in English you prefer Foreword to Acknowledgements). The foreword comes before the abstract.

\begin{document}

% If you need a List of Acronyms, place them before the \startthesis command. You will need "\usepackage[nohyperlinks]{acronym}", see line 4.

% \section*{List of Acronyms}
% \begin{acronym}
%   \acro{TSO}{Transmission System Operator}
%   \acro{LSTM}{Long Short-Term Memory}
% \end{acronym}

\startthesis % This command will separate the Roman-numbered pages above and the Arabic-numbered pages below as well as create the table of contents, list of figures, list of tables, and potentially list of acronyms


\section{Introduction}

\clearpage % separate each section with a \clearpage
\section{Mathematical background}
\subsection{The forward operator}
\input{figures/forward_operator.tex}

Let $\Omega \subset \mathbb R^2$ be a bounded domain with boundary $\partial \Omega$. I consider the following second-oder elliptic boundary value problem (BVP):
\begin{eqnarray}\label{eq:pde}
    \begin{aligned}
    -\nabla \cdot \sigma\nabla u + ku &= f \quad \text{in } \Omega, \\
    \frac{\partial u}{\partial \v n} &= 0 \quad \text{on } \partial\Omega,
    \end{aligned}
\end{eqnarray}
where $k > 0$ and $\sigma, f \in L^2(\Omega)$ (TODO: hva er $\sigma$). This is a diffusion-reaction equation with Neumann boundary conditions. Equation~\eqref{eq:pde} defines a mapping $\mathcal S: L^2(\Omega) \rightarrow L^2(\Omega)$. If $f \in L^2(\omega)$ is the source function (the input), then Equation~\eqref{eq:pde} maps $f$ to $\mathcal S f = u$ (the output). 

Introduce the trace operator $\mathcal T: L^2(\Omega) \rightarrow L^2(\partial\Omega)$, defined by
\begin{equation}\label{eq:trace}
    \mathcal T: u \mapsto g = u|_{\partial\Omega}.
\end{equation}
$\mathcal T u$ represents the observed values of $u$ on the boundary of $\Omega$. Operator~\eqref{eq:pde} and \eqref{eq:trace} defines the forward operator $\mathcal K: L^2(\Omega) \rightarrow L^2(\partial\Omega)$, 
\begin{equation}
    \mathcal K = \mathcal T \circ \mathcal S,
\end{equation}
which is a mapping from the source function $f$ to the observed output $g = \mathcal K f$ on the boundary $\partial \Omega$. Figure~\ref{fig:forward_operator} illustrates the components of the forward operator.


\subsection{The variational formulation}
To derive a finite element formulation of Eq.~\eqref{eq:pde} and the forward operator $\mathcal K$, I first reformulate the boundary value problem in its variational formulation, also the its weak formulation.

Multiplying the differential equation by a test function $v \in L^2(\Omega)$, integrating over $\Omega$, and using Green's equation, yields to the following variational formulation: find $u \in L^2(\Omega)$ such that
\begin{equation}
    \int_{\Omega} (\sigma \nabla u \cdot \nabla v + k u v) \, dx = \int_{\Omega} f v \space \, dx,
    \text{ for all } v \in L^2(\Omega).
\end{equation}
For details, see Section~4 in Larson and Bengzon \cite{larson_finite_2013}.


\subsection{The finite element method}
\input{figures/triangulation.tex}
Let $\mathcal M$ be a triangulation of $\Omega$ made up of $N$ nodes, with $N_b$ boundary nodes. See Fig.~\ref{fig:triangulation}. and define the finite element space
\begin{equation}\label{eq:fem_space}
    V_h = \{v \in C^0(\Omega) : v|_K \text{ is linear for all } M \in \mathcal M \}.
\end{equation}
This is the subspace $V_h \subset L^2(\Omega)$ of all continuous functions which are piecewise linear on $\mathcal M$. Multiplying Eq.~\eqref{eq:pde} by a function $v \in V_h$, integrating over $\Omega$, and using Green's formula, the finite element formulation of Eq.~\eqref{eq:pde} reads: find $u_h \in V_h$ such that
\begin{equation}\label{eq:fem_formulation}
    \int_\Omega \sigma \nabla u \cdot \nabla \phi_i \space dx + \int_\Omega k u \phi_i \space dx
= \int_\Omega f \phi_i \space dx, \quad i = 1,...,N,
\end{equation}
where $\{ \phi_1, \dots, \phi_N \}$ is a basis for $V_h$. See Section 4 in Larson and Bengzon for details \cite{larson_finite_2013}. Assume that $f \in V_h$. Then, both $f$ and $u_h$ can be written in terms of their basis functions,
\begin{equation}\label{eq:uh_and_f}
    u_h = \sum_{j=1}^{N} \xi_j \phi_j, \quad
    f = \sum_{j=1}^{N} \eta_j \phi_j.
\end{equation}
Inserting Eq.~\eqref{eq:uh_and_f} into Eq.~\eqref{eq:fem_formulation} gives the following matrix-vector equation,
\begin{equation}
    A \v{\xi} = M \v{\eta},
\end{equation}
where $A$ is the stiffness matrix, $M$ the mass matrix, and $\v \xi = [\xi_1, \cdots, \xi_N]^T$ and $\v \eta = [\eta_1, \cdots, \eta_N]^T$ are the coefficients vectors of $u_h$ and $f$, respectively. The discretization $S: \mathbb{R}^N \to \mathbb{R}^N$ of $\mathcal S$ is therefore
\begin{equation}\label{eq:discrete_S}
    S = A^{-1}M.
\end{equation}

The mesh $\mathcal M$ of the domain $\Omega$ is made up of $N$ nodes, with $N_i$ boundary nodes, which defines non-overlapping elements $M_i$, typically triangles in 2D. The discretization $T: \mathbb{R}^N \rightarrow \mathbb{R}^{N_i}$ of $\mathcal T$ is a matrix which extracts the boundary coefficients of a function. Each row has one element equal to 1, corresponding to the boundary node index, and 0s elsewhere. The discretized version of the forward operator $\mathcal K = \mathcal T \circ \mathcal S$ is therefore
\begin{equation}
    K = T S = T A^{-1} M.
\end{equation}
So, given the coefficients $\v \eta \in \mathbb{R}^N$ of a discrete source function $f$, $\v y = K \v \eta \in \mathbb{R}^{N_i}$ are the boundary coefficients of the output function $u_h$.


\subsection{Tikhonov regularization}
Theory on Tikhonov regularization,
\begin{equation}
    \min_{x \in \mathbb R^n} \| A x - b \|^2 + \lambda^2 \| x \|^2
\end{equation}


\subsection{Randomized SVD}
\input{figures/rsvd.tex}
The rSVD is a technique used to compute a rank-$k$ approximation of an $m\times n$ matrix without computing the SVD. The core idea is to use random sampling to find a low-rank matrix $Q$ which approximates the range of $A$, project $A$ onto $\operatorname{span}(Q)$, and compute the SVD of the projection. The projection $B=Q^TA$ will, with high probability, capture the dominant actions of $A$, and the SVD of $B$ will yield a good approximation \cite{halko_finding_2011}. This procedure is summarized in Algorithm \ref{alg:rsvd}. The construction of an orthonormal basis $Q$ of $Y$ is done through a QR factorization. Note that the approximation $A\approx QQ^T A$ and the approximate factorization $A\approx U\Sigma V^T$ produced by rSVD have the same error. This can be seen by observing that $QQ^TA = QB = Q\tilde U\Sigma V^T$, and setting $U=Q\tilde U$.
\begin{algorithm}[!h]
\caption{rSVD}
\label{alg:rsvd}
\begin{algorithmic}[1]
    \Require $A\in\mathbb R^{m\times n}$, target rank $k$, oversampling parameter $p$.
    \Ensure Approximate rank-$k$ factorization $U\Sigma V^T$.
    \State Generate a random $n\times(k+p)$ test matrix $\Omega$.
    \State Compute $Y = A\Omega$.
    \State Form an orthonormal basis $Q$ of $Y$.
    \State Set $B = Q^TA$.
    \State Compute the SVD $B = \tilde U\Sigma V^T$.
    \State Set $U = Q\tilde U$. 
\end{algorithmic}
\end{algorithm}


\subsection{Tips}
When you are closely following a book to explain something, which is often the case in a theory section, you can write at the start of the section you are about to introduce: ``This section follows closely the reference book by Sumiyoshi Abe and Yuko Okamoto, \emph{Nonextensive Statistical Mechanics and Its Applications}~\parencite[p.~32]{Abe2001nonextensive}.''

A Master's~\cite{LastName2045norwegian} or a PhD thesis~\cite{Temult2038binding} should include the name of the university wherein it was written, as well as the year. Moreover, it should include a URL to the work, when available.

\clearpage
\section{Methods}
\input{figures/S_and_T_example.tex}


\clearpage
\section{Literature Review}


\clearpage
\section{Methodology}
In the methodology, you might include mentions of various \texttt{python} (or other programming languages) packages.


\clearpage
\section{Results}


\clearpage
\section{Discussion}

\clearpage
\section{Conclusion}

% Note that the appendices should come after the bibliography, not before.
\clearpage
\references % This command prints out your bibliography

\clearpage
\appendices % This command is needed to start the appendix section and number the figures and tables accordingly. You should still use "\section"s to make your appendices.

\end{document}
